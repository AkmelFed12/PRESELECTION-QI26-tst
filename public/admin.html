<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Administration | Quiz Islamique 2026</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  
    <div class="page-actions" style="display:flex; justify-content:center; margin-bottom:16px;">
      <a href="index.html" class="btn-link outline">Retour √† l'accueil</a>
    </div><a class="skip-link" href="#mainContent">Aller au contenu</a>
    <header class="hero compact">
      <img src="assets/logo-association.svg" alt="Logo Les Serviteurs d'Allah" class="logo" />
      <div class="hero-content">
        <h1>Espace Administrateur</h1>
        <p class="subtitle">Gestion des inscriptions, votes, notations et d√©roul√© de la comp√©tition.</p>
      </div>
      <div class="hero-actions">
        <a href="index.html" class="btn-link outline">Accueil</a>
        <a href="quiz-2025.html" class="btn-link outline">LE QUIZ ISLAMIQUE 2025 en images</a>
        <button id="logoutBtn" class="btn-link outline hidden" type="button">D√©connexion</button>
      </div>
    </header>

    <main id="mainContent" class="layout admin-layout">
      <section class="card accent-gold">
        <h2>Connexion administrateur</h2>
        <form id="loginForm" class="grid-form">
          <label for="adminUsername">Identifiant</label>
          <input id="adminUsername" name="username" placeholder="Identifiant" autocomplete="username" required />
          <label for="adminPassword">Mot de passe</label>
          <input
            id="adminPassword"
            name="password"
            type="password"
            placeholder="Mot de passe"
            autocomplete="current-password"
            required
          />
          <button type="submit">Se connecter</button>
        </form>
        <p id="loginMsg" role="status" aria-live="polite"></p>
      </section>

      <section class="card accent-emerald hidden" id="adminPanel">
        <h2>Param√®tres du tournoi</h2>
        <form id="settingsForm" class="grid-form two-col">
          <label>Nombre maximal de candidats <input name="maxCandidates" type="number" /></label>
          <label>Qualifi√©s directs (groupe unique) <input name="directQualified" type="number" /></label>
          <label>Participants barrages <input name="playoffParticipants" type="number" /></label>
          <label>Vainqueurs barrages <input name="playoffWinners" type="number" /></label>
          <label>Nombre de groupes <input name="groupsCount" type="number" /></label>
          <label>Candidats par groupe <input name="candidatesPerGroup" type="number" /></label>
          <label>Finalistes (1ers de groupe) <input name="finalistsFromWinners" type="number" /></label>
          <label>Finalistes (meilleurs 2√®mes) <input name="finalistsFromBestSecond" type="number" /></label>
          <label>Total finalistes <input name="totalFinalists" type="number" /></label>
          <label class="toggle">
            <input name="votingEnabled" type="checkbox" />
            <span>Ouvrir les votes au public</span>
          </label>
          <label class="toggle">
            <input name="registrationLocked" type="checkbox" />
            <span>Verrouiller les inscriptions</span>
          </label>
          <label class="toggle">
            <input name="competitionClosed" type="checkbox" />
            <span>Clore la comp√©tition (inscriptions + votes)</span>
          </label>
          <label class="full">
            Message d'annonce
            <textarea name="announcementText" placeholder="Message affich√© sur l'accueil"></textarea>
          </label>
          <label class="full">
            Calendrier (JSON)
            <textarea
              name="scheduleJson"
              placeholder='[{"date":"10-02-2026","title":"Pr√©s√©lection","time":"09:00"}]'></textarea>
          </label>
          <button type="submit">Mettre √† jour</button>
        </form>
        <p id="settingsMsg" role="status" aria-live="polite"></p>
      </section>

      <section class="card accent-emerald hidden" id="securityPanel">
        <h2>S√©curit√© & Authentification</h2>
        <form id="passwordForm" class="grid-form">
          <label for="passwordCurrent">Mot de passe actuel</label>
          <input id="passwordCurrent" name="currentPassword" type="password" placeholder="Mot de passe actuel" required />
          <label for="passwordNew">Nouveau mot de passe</label>
          <input id="passwordNew" name="newPassword" type="password" placeholder="Nouveau mot de passe" required />
          <label for="passwordConfirm">Confirmer le nouveau mot de passe</label>
          <input id="passwordConfirm" name="confirmPassword" type="password" placeholder="Confirmation" required />
          <button type="submit">Changer le mot de passe</button>
        </form>
        <p id="passwordMsg" role="status" aria-live="polite"></p>
      </section>


      <section class="card accent-slate hidden" id="dashboardPanel">
        <h2>Tableau de bord</h2>
        <div class="dash-grid">
          <div class="dash-card">
            <span>Candidats inscrits</span>
            <strong id="statCandidates">0</strong>
          </div>
          <div class="dash-card">
            <span>Votes exprim√©s</span>
            <strong id="statVotes">0</strong>
          </div>
          <div class="dash-card">
            <span>Passages not√©s</span>
            <strong id="statScores">0</strong>
          </div>
          <div class="dash-card">
            <span>Inscriptions</span>
            <strong id="registrationLockStatus">Ouvertes</strong>
            <button class="small-btn" id="toggleRegistrationLock" type="button">Verrouiller</button>
          </div>
          <div class="dash-card">
            <span>Votes public</span>
            <strong id="votingStatus">Ferm√©s</strong>
            <button class="small-btn" id="toggleVoting" type="button">Ouvrir</button>
          </div>
          <div class="dash-card full">
            <span>Progression des inscriptions</span>
            <div class="progress">
              <div class="progress-bar" id="progressBar"></div>
            </div>
            <em id="progressText">0%</em>
          </div>
        </div>

        <h3 style="margin-top: 2rem; margin-bottom: 1rem;">Graphiques statistiques</h3>
        <div class="charts-grid">
          <div class="chart-container">
            <h4>Top 10 candidats (votes)</h4>
            <canvas id="chartTopVotes"></canvas>
          </div>
          <div class="chart-container">
            <h4>R√©partition g√©ographique</h4>
            <canvas id="chartCountries"></canvas>
          </div>
          <div class="chart-container">
            <h4>Top 10 candidats (scores)</h4>
            <canvas id="chartTopScores"></canvas>
          </div>
          <div class="chart-container">
            <h4>√âvolution des inscriptions</h4>
            <canvas id="chartInscriptions"></canvas>
          </div>
        </div>
      </section>

      <section class="card accent-olive hidden" id="candidatesPanel">
        <h2>Gestion des candidats</h2>
        <div class="toolbar">
          <input id="candidateSearch" type="search" placeholder="Rechercher un candidat (nom, pays, WhatsApp)" />
          <select id="candidateSort">
            <option value="id-desc">Tri: ID (desc)</option>
            <option value="name-asc">Tri: Nom (A-Z)</option>
            <option value="country-asc">Tri: Pays (A-Z)</option>
          </select>
          <select id="candidateStatusFilter">
            <option value="">Statut: tous</option>
            <option value="pending">En attente</option>
            <option value="approved">Valid√©</option>
            <option value="eliminated">√âlimin√©</option>
          </select>
          <label class="inline-check">
            <input type="checkbox" id="candidatePhotoFilter" />
            <span>Sans photo</span>
          </label>
        </div>
        <form id="candidateForm" class="grid-form two-col">
          <label for="candidateId">ID candidat (pour modifier)</label>
          <input id="candidateId" name="candidateId" type="number" placeholder="ID candidat" />
          <label for="candidateCode">Code candidat (auto)</label>
          <input id="candidateCode" name="candidateCode" placeholder="Code candidat" readonly />
          <label for="candidateFullName">Nom complet</label>
          <input id="candidateFullName" name="fullName" placeholder="Nom complet" required />
          <label for="candidateAge">√Çge</label>
          <input id="candidateAge" name="age" type="number" placeholder="√Çge" min="10" max="99" />
          <label for="candidateCity">Ville</label>
          <input id="candidateCity" name="city" placeholder="Ville" />
          <label for="candidateCountry">Pays</label>
          <input id="candidateCountry" name="country" placeholder="Pays" />
          <label for="candidateEmail">Email</label>
          <input id="candidateEmail" name="email" type="email" placeholder="Email" />
          <label for="candidatePhone">T√©l√©phone</label>
          <input id="candidatePhone" name="phone" placeholder="T√©l√©phone" />
          <label for="candidateWhatsapp">WhatsApp *</label>
          <input id="candidateWhatsapp" name="whatsapp" placeholder="WhatsApp" required />
          <label for="candidateLevel">Niveau en culture islamique</label>
          <select id="candidateLevel" name="quranLevel">
            <option value="">Niveau en culture islamique</option>
            <option>D√©butant</option>
            <option>Interm√©diaire</option>
            <option>Avanc√©</option>
          </select>
          <label for="candidateStatus">Statut</label>
          <select id="candidateStatus" name="status">
            <option value="pending">Statut: en attente</option>
            <option value="approved">Statut: valid√©</option>
            <option value="eliminated">Statut: √©limin√©</option>
          </select>
          <label for="candidateMotivation">Motivation (facultatif)</label>
          <textarea id="candidateMotivation" name="motivation" placeholder="Motivation"></textarea>
          <label for="candidatePhotoFile">Photo du candidat</label>
          <input id="candidatePhotoFile" name="photoFile" type="file" accept="image/*" />
          <div class="photo-preview">
            <img id="candidatePreview" alt="Aper√ßu du candidat" />
          </div>
          <label for="candidatePhotoUrl">Lien photo (auto apr√®s upload)</label>
          <input id="candidatePhotoUrl" name="photoUrl" type="text" placeholder="Lien photo" readonly />
          <button type="submit">Enregistrer le candidat</button>
        </form>
        <p id="candidateMsg" role="status" aria-live="polite"></p>
        <div class="table-wrap">
          <h3>Liste des candidats</h3>
          <table id="adminCandidatesTable">
            <thead><tr><th>Photo</th><th>Code</th><th>Nom</th><th>Pays</th><th>Statut</th><th>Score total</th><th>WhatsApp</th><th>Actions</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="card accent-sand hidden" id="scorePanel">
        <h2>Noter un candidat apr√®s son passage</h2>
        <form id="scoreForm" class="grid-form two-col">
          <label for="scoreCandidateId">ID candidat</label>
          <input id="scoreCandidateId" name="candidateId" type="number" placeholder="ID candidat" required />
          <label for="scoreJudgeName">Nom du juge</label>
          <input id="scoreJudgeName" name="judgeName" placeholder="Nom du juge" required />
          <label for="scoreChosen">Th√®me au choix /15</label>
          <input id="scoreChosen" name="themeChosenScore" type="number" step="0.1" placeholder="Th√®me au choix /15" />
          <label for="scoreImposed">Th√®me impos√© /15</label>
          <input id="scoreImposed" name="themeImposedScore" type="number" step="0.1" placeholder="Th√®me impos√© /15" />
          <label for="scoreNotes">Notes compl√©mentaires</label>
          <textarea id="scoreNotes" name="notes" placeholder="Notes compl√©mentaires"></textarea>
          <button type="submit">Enregistrer la note</button>
        </form>
        <p id="scoreMsg" role="status" aria-live="polite"></p>
      </section>

      <section class="card accent-slate hidden" id="tablesPanel">
        <h2>Tableaux de suivi</h2>
        <div class="table-wrap">
          <h3>Inscriptions</h3>
          <div class="table-actions">
            <button class="small-btn" id="exportCandidates" type="button">Exporter CSV</button>
          </div>
          <table id="candidatesTable">
            <thead><tr><th>ID</th><th>Nom</th><th>WhatsApp</th><th>Pays</th><th>Date</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="table-wrap">
          <h3>Classement des votes</h3>
          <div class="table-actions">
            <button class="small-btn" id="exportVotes" type="button">Exporter CSV</button>
          </div>
          <table id="votesTable">
            <thead><tr><th>Candidat</th><th>Total votes</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="table-wrap">
          <h3>Classement des notes</h3>
          <div class="table-actions">
            <button class="small-btn" id="exportRanking" type="button">Exporter CSV</button>
            <button class="small-btn" id="exportRankingPdf" type="button">Exporter PDF</button>
          </div>
          <table id="rankingTable">
            <thead><tr><th>Candidat</th><th>Moyenne /30</th><th>Passages not√©s</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="table-wrap">
          <h3>Messages de contact</h3>
          <div class="table-actions">
            <input id="contactSearch" type="search" placeholder="Rechercher (nom, email, objet)" />
            <select id="contactFilter">
              <option value="active">Actifs</option>
              <option value="archived">Archiv√©s</option>
              <option value="all">Tous</option>
            </select>
            <button class="small-btn" id="exportContacts" type="button">Exporter CSV</button>
          </div>
          <table id="contactTable">
            <thead><tr><th>Date</th><th>Nom</th><th>Email</th><th>Objet</th><th>Message</th><th>IP</th><th>Actions</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="table-wrap">
          <h3>Journal d'administration</h3>
          <div class="table-actions">
            <button class="small-btn" id="exportAudit" type="button">Exporter CSV</button>
          </div>
          <table id="auditTable">
            <thead><tr><th>Date</th><th>Action</th><th>D√©tails</th><th>IP</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- POSTS Management -->
      <section class="card accent-purple hidden" id="postsPanel">
        <h2>üì∞ Gestion des Publications</h2>
        <p>Approuver ou rejeter les publications soumises par les utilisateurs.</p>
        <div class="table-wrap">
          <table id="postsAdminTable">
            <thead>
              <tr>
                <th>Auteur</th>
                <th>Contenu</th>
                <th>Statut</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- STORIES Management -->
      <section class="card accent-purple hidden" id="storiesPanel">
        <h2>üì± Gestion des Stories</h2>
        <p>Approuver ou rejeter les stories (visibilit√© 24h). Les stories expir√©es sont auto-supprim√©es.</p>
        <div class="table-wrap">
          <table id="storiesAdminTable">
            <thead>
              <tr>
                <th>Auteur</th>
                <th>Contenu</th>
                <th>Statut</th>
                <th>Expire dans</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- DONATIONS Management -->
      <section class="card accent-gold hidden" id="donationsPanel">
        <h2>üíù Gestion des Donations</h2>
        <p id="donationStats" class="muted-note">Total confirm√©: 0 FCA | Donations: 0</p>
        <button class="small-btn" id="exportDonations">Exporter donations (CSV)</button>
        <div class="table-wrap">
          <table id="donationsAdminTable">
            <thead>
              <tr>
                <th>Donateur</th>
                <th>Montant</th>
                <th>M√©thode</th>
                <th>Statut</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Media Gallery Management -->
      <section class="card accent-slate hidden" id="mediaPanel">
        <h2>üì∏ Gestion Galerie Quiz 2025</h2>
        <div class="table-wrap">
          <h3>Gestion galerie Quiz 2025</h3>
          <p id="mediaAdminStats" class="muted-note">M√©dias: 0 | Vues: 0 | T√©l√©chargements: 0</p>
          <div class="table-actions">
            <input id="mediaSearchAdmin" type="search" placeholder="Rechercher un m√©dia..." />
            <select id="mediaTypeAdmin">
              <option value="all">Tous</option>
              <option value="image">Photos</option>
              <option value="video">Vid√©os</option>
            </select>
            <select id="mediaSortAdmin">
              <option value="newest">Plus r√©cents</option>
              <option value="oldest">Plus anciens</option>
              <option value="name">Nom (A-Z)</option>
            </select>
            <button class="small-btn" id="mediaAdminReload" type="button">Rafra√Æchir</button>
          </div>
          <table id="mediaAdminTable">
            <thead>
              <tr>
                <th>Nom</th>
                <th>Type</th>
                <th>Ordre</th>
                <th>Masqu√©</th>
                <th>L√©gende</th>
                <th>Stats</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="utils.js?v=2.2.0"></script>
    <script src="admin.js?v=2.2.0"></script>
      <footer class="site-footer">
      <div>
        <strong>Association des Serviteurs d'Allah Azawajal</strong>
        <p>Plateforme officielle de pr√©s√©lection du Quiz Islamique 2026.</p>
        <p class="footer-signature">Design &amp; Development by LMO Web Services</p>
      </div>
      <div class="footer-links">
        <a href="contact.html">Contact</a>
        <a href="quiz-2025.html">Quiz 2025 en images</a>
        <a href="confidentialite.html">Politique de confidentialit√©</a>
        <a href="mentions-legales.html">Mentions l√©gales</a>
      </div>
    </footer>
  </body>
</html>


