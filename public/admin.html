<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Administration | Quiz Islamique 2026</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header class="hero compact">
      <img src="assets/logo-association.svg" alt="Logo Les Serviteurs d'Allah" class="logo" />
      <div class="hero-content">
        <h1>Espace Administrateur</h1>
        <p class="subtitle">Gestion des inscriptions, votes, notations et déroulé de la compétition.</p>
      </div>
      <div class="hero-actions">
        <a href="index.html" class="btn-link outline">Accueil</a>
        <button id="logoutBtn" class="btn-link outline hidden" type="button">Déconnexion</button>
      </div>
    </header>

    <main class="layout admin-layout">
      <section class="card accent-gold">
        <h2>Connexion administrateur</h2>
        <form id="loginForm" class="grid-form">
          <input name="username" placeholder="Identifiant" required />
          <input name="password" type="password" placeholder="Mot de passe" required />
          <button type="submit">Se connecter</button>
        </form>
        <p id="loginMsg"></p>
      </section>

      <section class="card accent-emerald hidden" id="adminPanel">
        <h2>Paramètres du tournoi</h2>
        <form id="settingsForm" class="grid-form two-col">
          <label>Nombre maximal de candidats <input name="maxCandidates" type="number" /></label>
          <label>Qualifiés directs (groupe unique) <input name="directQualified" type="number" /></label>
          <label>Participants barrages <input name="playoffParticipants" type="number" /></label>
          <label>Vainqueurs barrages <input name="playoffWinners" type="number" /></label>
          <label>Nombre de groupes <input name="groupsCount" type="number" /></label>
          <label>Candidats par groupe <input name="candidatesPerGroup" type="number" /></label>
          <label>Finalistes (1ers de groupe) <input name="finalistsFromWinners" type="number" /></label>
          <label>Finalistes (meilleurs 2èmes) <input name="finalistsFromBestSecond" type="number" /></label>
          <label>Total finalistes <input name="totalFinalists" type="number" /></label>
          <label class="toggle">
            <input name="votingEnabled" type="checkbox" />
            <span>Ouvrir les votes au public</span>
          </label>
          <label class="toggle">
            <input name="registrationLocked" type="checkbox" />
            <span>Verrouiller les inscriptions</span>
          </label>
          <button type="submit">Mettre à jour</button>
        </form>
        <p id="settingsMsg"></p>
      </section>

      <section class="card accent-slate hidden" id="dashboardPanel">
        <h2>Tableau de bord</h2>
        <div class="dash-grid">
          <div class="dash-card">
            <span>Candidats inscrits</span>
            <strong id="statCandidates">0</strong>
          </div>
          <div class="dash-card">
            <span>Votes exprimés</span>
            <strong id="statVotes">0</strong>
          </div>
          <div class="dash-card">
            <span>Passages notés</span>
            <strong id="statScores">0</strong>
          </div>
          <div class="dash-card full">
            <span>Progression des inscriptions</span>
            <div class="progress">
              <div class="progress-bar" id="progressBar"></div>
            </div>
            <em id="progressText">0%</em>
          </div>
        </div>
      </section>

      <section class="card accent-olive hidden" id="candidatesPanel">
        <h2>Gestion des candidats</h2>
        <div class="toolbar">
          <input id="candidateSearch" type="search" placeholder="Rechercher un candidat (nom, pays, WhatsApp)" />
          <select id="candidateSort">
            <option value="id-desc">Tri: ID (desc)</option>
            <option value="name-asc">Tri: Nom (A-Z)</option>
            <option value="country-asc">Tri: Pays (A-Z)</option>
          </select>
          <select id="candidateStatusFilter">
            <option value="">Statut: tous</option>
            <option value="pending">En attente</option>
            <option value="approved">Validé</option>
            <option value="eliminated">Éliminé</option>
          </select>
        </div>
        <form id="candidateForm" class="grid-form two-col">
          <input name="candidateId" type="number" placeholder="ID candidat (pour modifier)" />
          <input name="fullName" placeholder="Nom complet" required />
          <input name="age" type="number" placeholder="Âge" min="10" max="99" />
          <input name="city" placeholder="Ville" />
          <input name="country" placeholder="Pays" />
          <input name="email" type="email" placeholder="Email" />
          <input name="phone" placeholder="Téléphone" />
          <input name="whatsapp" placeholder="WhatsApp *" required />
          <select name="quranLevel">
            <option value="">Niveau en culture islamique</option>
            <option>Débutant</option>
            <option>Intermédiaire</option>
            <option>Avancé</option>
          </select>
          <select name="status">
            <option value="pending">Statut: en attente</option>
            <option value="approved">Statut: validé</option>
            <option value="eliminated">Statut: éliminé</option>
          </select>
          <textarea name="motivation" placeholder="Motivation (facultatif)"></textarea>
          <input name="photoFile" type="file" accept="image/*" />
          <div class="photo-preview">
            <img id="candidatePreview" alt="Aperçu du candidat" />
          </div>
          <input name="photoUrl" type="text" placeholder="Lien photo (auto après upload)" readonly />
          <button type="submit">Enregistrer le candidat</button>
        </form>
        <p id="candidateMsg"></p>
        <div class="table-wrap">
          <h3>Liste des candidats</h3>
          <table id="adminCandidatesTable">
            <thead><tr><th>Photo</th><th>ID</th><th>Nom</th><th>Pays</th><th>Statut</th><th>WhatsApp</th><th>Actions</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="card accent-sand hidden" id="scorePanel">
        <h2>Noter un candidat après son passage</h2>
        <form id="scoreForm" class="grid-form two-col">
          <input name="candidateId" type="number" placeholder="ID candidat" required />
          <input name="judgeName" placeholder="Nom du juge" required />
          <input name="themeChosenScore" type="number" step="0.1" placeholder="Thème au choix /15" />
          <input name="themeImposedScore" type="number" step="0.1" placeholder="Thème imposé /15" />
          <textarea name="notes" placeholder="Notes complémentaires"></textarea>
          <button type="submit">Enregistrer la note</button>
        </form>
        <p id="scoreMsg"></p>
      </section>

      <section class="card accent-slate hidden" id="tablesPanel">
        <h2>Tableaux de suivi</h2>
        <div class="table-wrap">
          <h3>Inscriptions</h3>
          <div class="table-actions">
            <button class="small-btn" id="exportCandidates" type="button">Exporter CSV</button>
          </div>
          <table id="candidatesTable">
            <thead><tr><th>ID</th><th>Nom</th><th>WhatsApp</th><th>Pays</th><th>Date</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="table-wrap">
          <h3>Classement des votes</h3>
          <div class="table-actions">
            <button class="small-btn" id="exportVotes" type="button">Exporter CSV</button>
          </div>
          <table id="votesTable">
            <thead><tr><th>Candidat</th><th>Total votes</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="table-wrap">
          <h3>Classement des notes</h3>
          <div class="table-actions">
            <button class="small-btn" id="exportRanking" type="button">Exporter CSV</button>
            <button class="small-btn" id="exportRankingPdf" type="button">Exporter PDF</button>
          </div>
          <table id="rankingTable">
            <thead><tr><th>Candidat</th><th>Moyenne /30</th><th>Passages notés</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </main>

    <script src="admin.js"></script>
  </body>
</html>
