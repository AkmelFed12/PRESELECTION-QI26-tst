databases:
  - name: preselection-qi26-db
    plan: free

services:
  - type: web
    name: preselection-qi26
    env: python
    plan: free
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: preselection-qi26-db
          property: connectionString
      - key: ADMIN_USERNAME
        value: admin
      - key: ADMIN_PASSWORD
        value: ASAALMO2026
    buildCommand: "python -m pip install --upgrade pip && pip install -r requirements.txt"
    startCommand: "python app.py"
    autoDeploy: true
  - type: cron
    name: preselection-qi26-backup
    env: python
    plan: free
    schedule: "0 2 * * *"
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: preselection-qi26-db
          property: connectionString
    buildCommand: "apt-get update && apt-get install -y postgresql-client rclone"
    startCommand: "bash scripts/backup_db.sh"
